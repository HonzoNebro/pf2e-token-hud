<div class="spells">
    {{#if spells.length}}
    {{#each spells as |entry|}}
    {{#if entry includeZero=true}}
    <div class="entry">
        <div class="header">
            {{#if (eq @index 0)}}
            {{localize 'PF2E.SpellCantripLabel'}}
            {{else if (eq @index 12)}}
            {{localize 'PF2E.Focus.Spells'}}
            {{else}}
            {{localize (concat 'PF2E.SpellLevel' @index)}}
            {{/if}}

            {{#if (or (eq @index 12) (and (eq @index 0) @root.hasFocusCantrips))}}
            <div class="pips" data-action="toggle-pips">
                {{#times @root.focusPool.max}}
                <div class="pip">
                    <i class="{{#if (gt @root.focusPool.value this)}}fas fa-dot-circle{{else}}far fa-circle{{/if}}"></i>
                </div>
                {{/times}}
            </div>
            {{/if}}
        </div>
        {{#each entry as |spell|}}
        <div class="spell item-box{{#if spell.expended}} expended{{/if}}{{#if spell.isVirtual}} virtual{{/if}}"
            data-entry-id="{{spell.entryId}}" data-slot-id="{{spell.slotId}}" data-expended="{{spell.expended}}"
            data-slot-level="{{spell.slotLevel}}" data-item-id="{{spell.itemId}}" data-cast-level="{{spell.castLevel}}">
            <div class="item-img hover" data-action="spell-chat">
                <img src="{{spell.img}}">
                {{#if @root.isOwner}}
                <i class="fa-solid fa-message"></i>
                {{/if}}
            </div>
            <div class="details">
                <a class="name" data-action="spell-description">{{spell.name}}</a>
                <div class="extras">
                    <div class="type">
                        {{#if spell.tradition}}{{spell.tradition}}| {{/if}}
                        {{localize spell.type}} {{{actionGlyph spell.action}}}
                    </div>
                    <div class="actions">
                        {{#unless spell.isCantrip}}

                        {{#if (or spell.isSpontaneous spell.isInnate spell.isCharge)}}
                        <div class="uses">
                            <input type="number" value="{{spell.uses.value}}" data-input-path="{{spell.inputPath}}"
                                data-entry-id="{{#if spell.isInnate}}{{spell.itemId}}{{else}}{{spell.entryId}}{{/if}}" placeholder="0"
                                min="0" max="{{spell.uses.max}}" {{disabled (or spell.isCharge (not @root.isOwner))}}>
                            {{#if spell.uses.max}}
                            <input type="text" value="/  {{spell.uses.max}}" disabled>
                            {{!-- {{else if spell.isCharge}}
                            <a data-action="recharge-staff"><i class="fas fa-redo"></i></a> --}}
                            {{/if}}
                        </div>

                        {{else if (and spell.isPrepared @root.isOwner)}}
                        <a data-action="toggle-prepared">
                            <i class="fas fa-fw {{#if spell.expended}}fa-plus-square{{else}}fa-minus-square{{/if}}"></i>
                        </a>

                        {{/if}}

                        {{/unless}}

                        {{#if @root.isOwner}}
                        <a {{#if spell.expended}}class="disabled" {{else}}data-action="cast-spell" {{/if}}>
                            <i class="fa-duotone fa-play"></i>
                        </a>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
    {{/if}}
    {{/each}}
    {{/if}}

    {{#if rituals.length}}
    <div class="entry">
        <div class="header">{{localize 'PF2E.SpellRitualLabel'}}</div>
        {{#each rituals as |ritual|}}
        <div class="spell item-box" data-slot-level="{{ritual.level}}" data-slot-id="{{ritual.slotId}}" data-entry-id="rituals"
            data-item-id="{{ritual.itemId}}">
            <div class="item-img" data-action="show-description">
                <img src="{{ritual.img}}">
                <i class="fa-solid fa-circle-question"></i>
            </div>
            <div class="details">
                <div class="name">{{ritual.name}}</div>
                <div class="extras">
                    <div class="type">{{localize 'PF2E.LevelN' level=ritual.level}}</div>
                    <div class="actions">
                        <span>{{ritual.time}}</span>
                        {{#if @root.isOwner}}
                        <a data-action="cast-spell">
                            <i class="fa-duotone fa-play"></i>
                        </a>
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
    {{/if}}
</div>